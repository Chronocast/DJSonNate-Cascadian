<!--
	Author: Nate Hascup, Duck Nguyen, Jeremy Manalo, Sonie Moon
	Date: 10/13/17
	Filename: home.html
	Description: Admin page for Track-king. Cascadian Landworks tracking system.
-->

	<include href="pages/admin-header.html" />
	<title>Admin | Cascadian Landworks Tracking</title>
	<link rel="stylesheet" type="text/css" href="./css/admin.css">
</head>
	
	<!-- ADMIN - NAVIGATION -->
	<include href="pages/admin-navbar.html"/>
	
	<!-- ACTIVE PROJECT START -->
	<div id="active-div" class="portfolio container-fluid">
		<div class="col-sm-12">
			<h1>Active Projects:</h1>
		</div>
		
		<!-- CARD DECK/COLUMNS START -->
		<div class="card-deck">
			
			<!-- repeat to display templated data -->  
			<repeat group="{{ @projectDisplay }}" value="{{ @track }}">
				
				<!-- CARD START -->
				<div class="card mx-auto">
					
					<!-- CARD TITLE + OPTIONS BUTTONS-->
					<button type="button" class="btn btn-title btn-block" data-toggle="modal" data-target="#infoModal-{{ @track['track_id'] }}">
						<h3>{{ @track['project_name'] }}</h3>
					</button>
					
					<!-- TOOLS BUTTONS START -->
					<div class="d-inline-block text-center data-{{ @i }}">						
						<!-- OVERVIEW BUTTON START -->
						<a class="showStep" target="{{ @i }}">
							<button type="button"  title="Overview" class="btn btn-warning" alt="Overview"> 
								<i class="fa fa-info-circle"></i>
							</button>				
						</a>
						<!-- OVERVIEW BUTTON START -->
					
						<!-- DOCUMENT BUTTON START -->
						<a class="showStep" target="{{ @i + 1 }}">
							<button type="button" title="Documents" class="btn btn-warning" alt="Documents" >
								<i class="fa fa-file-text"></i> 
							</button>
						</a>
						<!-- DOCUMENT BUTTON END -->
						
						<!-- SCHEDULING BUTTON START -->
						<a class="showStep" target="{{ @i + 2 }}">
							<button type="button"  title="Schedule & Labor" class="btn btn-warning" alt="Schedule"> 
								<i class="fa fa-truck"></i> 
							</button>				
						</a>
						<!-- SCHEDULING BUTTON START -->
						
						<!-- CONSTRUCTION BUTTON START -->
						<a class="showStep" target="{{ @i + 3 }}">
							<button type="button"  title="Construction" class="btn btn-warning" alt="Construction"> 
								<i class="fa fa-cubes"></i> 
							</button>
						</a>
						<!-- CONSTRUCTION BUTTON END -->
						
						
						<!-- PUNCH LIST BUTTON START -->
						<a class="showStep" target="{{ @i + 4 }}">
							<button type="button" title="Punch List" class="btn btn-warning" alt="Punch List"> 
								<i class="fa fa-list-ol"></i> 
							</button>
						</a>
						<!-- PUNCH LIST BUTTON END -->
						
						
						<!-- APPROVAL BUTTON START -->
						<a class="showStep" target="{{ @i + 5 }}">
							<button type="button" title="Approval" class="btn btn-warning" alt="Approval"> 
								<i class="fa fa-check"></i> 
							</button>
						</a>
						<!-- APPROVAL BUTTON END -->
					</div>
					<!-- TOOLS BUTTONS END -->
					
					<!-- CARD BODY -->
					<div class="card-body">
						
						<!-- OVERVIEW START -->
						<div id="div{{ @i }}" class="targetDiv{{ @i }} overview{{ @i }}">
							<div class="overview-headings">
								<div class="card-title">
									<h5>Overview:</h5>
								</div>
								<div class="main-options">
									<a href=""><i class="fa fa-pencil-square" aria-hidden="true"></i></a>
									<a href=""><i class="fa fa-archive" aria-hidden="true"></i></a>
								</div>
							</div>
							<br>
							<p class="card-text">Tracking # {{ @track['track_id'] }}</p>
							<p class="card-text">Start Date: {{ @track['start_date'] }}</p>
							<p class="card-text">End Date: {{ @track['end_date'] }}</p>
							<p>{{ @track['project_description'] }}</p>
						</div>
						
						<!-- DOCUMENTS START -->
						<div id="div{{ @i + 1 }}" class="targetDiv{{ @i }}">
							<div class="overview-headings">
								<div class="card-title">
									<h5>Documents:</h5>
								</div>
								<div class="main-options">
									<form action="./upload" method="post" enctype="multipart/form-data" class="upload-document form-inline">
										<div class="form-group">
											<input type="hidden" name="projectID" value="{{ @track['track_id'] }}"/>
											<input type="text" placeholder="Title" name="fileTitle" required/><br>
										</div>
										<div class="form-group">
											<!--<a href="#" class="input"/><i class="fa fa-plus-square" aria-hidden="true"></i> ADD</a><span class="imgName"></span>-->
											<input type="file" name="fileInput" class="fileID" accept="image/*" required/>
										</div>
										<!--<input name="action" type="submit" value="Add Document" class="btn">-->
										<button name="action" type="submit"/><i class="fa fa-plus-square" aria-hidden="true"></i> ADD</a><span class="imgName"></span>
									</form>
								</div>
							</div>
							<br>
							
							<table class="table table-striped">
								<thead>
									<tr>
										<th>Document tittle</th>
										<th>View</th> <!-- is this necessary -->
										<th>Edit</th>
										<th>Delete</th>
									</tr>
								</thead>
								
								<tbody>
									<!-- CHECK FOR VALID DOC -->
									<repeat group="{{ @docDisplay }}" value="{{ @doc }}">
										<check if="{{ @doc['track_id'] == @track['track_id'] }}">
											<true>
												<tr>
													<td>{{ @doc['documentLink'] }}</td>
													<td><i class="fa fa-download" aria-hidden="true"></i></td>
													<td><i class="fa fa-pencil-square" aria-hidden="true"></i></td>
													<td><a class="delete" data-toggle="modal" data-target="#delModal" id="{{ @doc['documentID'] }}" href="#"/><i class="fa fa-minus-square" aria-hidden="true"></i></a></td>
												</tr>
											</true>
										</check>
									</repeat>
								</tbody>
							</table>
						</div>
						
						<!-- SCHEDULING START -->
						<div id="div{{ @i + 2 }}" class="targetDiv{{ @i }}">
							<div class="card-title">
								<h5>Scheduling:</h5>
							</div>
							<div class="main-options">
								<a href=""><i class="fa fa-plus-square" aria-hidden="true"></i> ADD</a>
							</div>
							<br>
							<table class="table table-striped">
								<thead>
									<tr>
										<th>Work type</th>
										<th>Quantity</th>
										<th>Notes</th>
										<th>Edit</th>
										<th>Delete</th>
									</tr>
								</thead>
								
								<tbody>
									<!-- CHECK FOR VALID SCHEDULE -->
									<repeat group="{{ @scheduleDisplay }}" value="{{ @schedule }}">
										<check if="{{ @schedule['track_id'] == @track['track_id'] }}">
											<true>
												<tr>
													<td>{{ @schedule['title'] }}</td>
													<td>{{ @schedule['quantity'] }}</td>
													<td>{{ @schedule['notes'] }}</td>
													<td><i class="fa fa-pencil-square" aria-hidden="true"></i></td>
													<td><i class="fa fa-minus-square" aria-hidden="true"></i></td>
												</tr>
											</true>
										</check>
									</repeat>
								</tbody>
							</table>
						</div>
						
						<!-- CONSTRUCTION START -->
						<div id="div{{ @i + 3 }}" class="targetDiv{{ @i }}">
							<div class="card-title">
								<h5>Consutrction:</h5>
							</div>
							<div class="main-options">
								<a href=""><i class="fa fa-plus-square" aria-hidden="true"></i> ADD</a>
							</div>
							<br>
							
							<table class="table table-striped">
								<thead>
									<tr>
										<th>Title</th>
										<!-- <th>Date</th>
										<th>Image</th> is this necessary? 
										<th>Details</td>-->
										<th>Edit</th>
										<th>Delete</th>
									</tr>
								</thead>
								
								<tbody>
									<!-- CHECK FOR VALID CONSTRUCTION INFO -->
									<repeat group="{{ @constructionDisplay }}" value="{{ @construction }}">
										<check if="{{ @construction['track_id']==@track['track_id'] }}">
											<true>
												<tr>
													<td>
														<div class="construction-heading">
															<h5>{{ @construction['reportName'] }}</h5>
															<p>{{ @construction['reportDate'] }}</p>
														</div>
														<div class="construction-body">
															<p><img src="{{ @construction['photo'] }}" class="construction-image">{{ @construction['details'] }}</p>
														</div>
													</td>
													<td><i class="fa fa-pencil-square" aria-hidden="true"></i></td>
													<td><i class="fa fa-minus-square" aria-hidden="true"></i></td>
												</tr>
											</true>
										</check>
									</repeat>
								</tbody>
							</table>
						</div>
						
						<!-- PUNCH LIST START -->
						<div id="div{{ @i + 4 }}" class="targetDiv{{ @i }}">
							<div class="card-title">
								<h5>Final Punch List:</h5>
							</div>
							<div class="main-options">
								<a href=""><i class="fa fa-plus-square" aria-hidden="true"></i> ADD</a>
							</div>
							<br>
							
							<table class="table table-striped">
								<thead>
									<tr>
										<th>{~ @num = 0 ~}</th>
										<th>Item</th>
										<th>Status</th>
										<th>Edit</th>
										<th>Delete</th>
									</tr>
								</thead>
								
								<tbody>
									<!-- CHECK FOR VALID PUNCH LIST INFO -->
									<repeat group="{{ @punchListDisplay }}" value="{{ @punchy }}">
										<check if="{{ @punchy['track_id']==@track['track_id'] }}">
											<true>
												<tr>
													<td>{{ @num++ }}</td>
													<td>{{ @punchy['name'] }}</td>
													<td>
														<check if="{{ @punchy['status']==0 }}">
															<true>Not done</true>
															<false>Done</false>
														</check>
													</td>
													<td><i class="fa fa-pencil-square" aria-hidden="true"></i></td>
													<td><i class="fa fa-minus-square" aria-hidden="true"></i></td>
												</tr>
											</true>
										</check>
									</repeat>
								</tbody>
							</table>
						</div>
						
						<!-- ACCEPTANCE START -->
						<div id="div{{ @i + 5 }}" class="targetDiv{{ @i }}">
							<h5 class="card-title">Acceptance:</h5>
							<p>{{ @track['project_name'] }}</p>
						</div>
					</div>										
					<!-- END CARD BODY -->
					
					<!-- CARD FOOTER START-->
					<div class="card-footer">
						<small class="text-muted">Last updated {{ @track['last_update'] }}</small>
					</div>				
				</div>
				<!-- END CARD -->
		
			
			 <!--incremental value-->
			{~ @i+=7 ~}
			
			</repeat>
			<!-- END repeat to display templated data -->			
		</div>
		<!-- CARD DECK/COLUMNS END -->
	</div>
	<!-- ACTIVE PROJECT END -->
	
	<!-- Delete Modal -->
	<div id="delModal" class="modal fade" role="dialog">
		<div class="modal-dialog">
			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Confirm Deletion</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					  <span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<form method="post" class="delete" action="./delete">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
						<input type="text" name="id" style="visibility: hidden;" id="delInput" value="" required/>
						<input name="action" type="submit" value="Confirm" class="btn">
					</form>
				</div>
			</div>
	
		</div>
	</div>
	
	<!-- ADMIN FOOTER WITH JS SCRIPTS-->
	<include href="pages/admin-footer.html" />